Thêm điều kiện kiểm tra IsRoot trong OrderService.cs:

Tìm đoạn code sau trong OrderService.cs (khoảng dòng 344-357):

```csharp
// Tìm voucher theo mã
var vouchers = await _voucherRepository.FindAsync(v => v.Code == voucherCode && v.IsActive == true);
var voucher = vouchers.FirstOrDefault();

if (voucher == null) continue;

// Kiểm tra điều kiện áp dụng voucher
if (voucher.MinOrder.HasValue && productTotal < voucher.MinOrder.Value)
    continue;

if (voucher.StartDate > DateTime.UtcNow || voucher.EndDate < DateTime.UtcNow)
    continue;

if (voucher.UsageLimit.HasValue && voucher.UsedCount >= voucher.UsageLimit)
    continue;
```

Và thêm điều kiện kiểm tra IsRoot sau dòng kiểm tra UsageLimit:

```csharp
// Chỉ áp dụng voucher không phải là voucher gốc (IsRoot = false)
if (voucher.IsRoot == true)
    continue;
```

Thêm điều kiện kiểm tra IsRoot trong ApplyVoucherRepository.cs:

Tìm đoạn code sau trong ApplyVoucherRepository.cs (khoảng dòng 52-63):

```csharp
// Verificar si el voucher está dentro de su período de validez
var now = DateTime.UtcNow;
if (voucher.StartDate > now || voucher.EndDate < now)
{
    return false; // Voucher fuera de período de validez
}

// Verificar si el voucher ha alcanzado su límite de uso
if (voucher.UsageLimit.HasValue && voucher.UsedCount >= voucher.UsageLimit)
{
    return false; // Voucher ha alcanzado su límite de uso
}
```

Và thêm điều kiện kiểm tra IsRoot sau đoạn kiểm tra UsageLimit:

```csharp
// Verificar si el voucher no es un voucher raíz (IsRoot = false)
if (voucher.IsRoot == true)
{
    return false; // No se puede aplicar un voucher raíz
}
```
